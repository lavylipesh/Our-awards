{% extends 'base.html' %}
{% block content %}
<div id="yeay">
  <h1 class="text-center" style="font-weight: 900;">Welcome To Awards!!  Your Project Counts :)</h1>
  <p style="color: ivory;" class="text-center"><strong>YOU CAN DO WHAT YOU BELIEVE !!</strong></p>
</div>

<div class="container-fluid">
  <br>
  <div class="row">
      {% for project in projects %}
      <div class="col-md-4">
          <div class="card">
              <img class="card-img-top" height="400px" src="{{project.image.url}}" alt="Card image cap">           
              <div class="card-body">
                  <p class="card-text"><strong>{{project.title}}</strong>:
                      {{project.description |truncatechars_html:170}}</p>
                  <p class="card-text"><strong>By</strong>:{{user.username}} </p>
                  <a href="{{project.link}}" target="_blank" class="btn btn-primary">Live site</a>
              </div>
          </div>
      </div>
      {% endfor %}
  </div>
</div>
{% endblock content %}




@login_required(login_url='/accounts/login/')
def likePost(request,image_id):

image = Post.objects.get(pk = image_id)

is_liked = False
if image.likes.filter(id = request.user.id).exists():
image.likes.remove(request.user)
is_liked = False
else:
image.likes.add(request.user)
is_liked = True

return HttpResponseRedirect(request.META.get('HTTP_REFERER'))
url(r'^like/(\d+)',views.likePost, name="likePost"),
likes = models.ManyToManyField(User, related_name= 'likes', blank = True)
def total_likes(self):
self.likes.count()